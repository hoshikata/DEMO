import{o as N,c as M,_ as U,u as q,s as I,a as o,b as S,d as B,I as A,t as j,r as C,e as O,n as z,f as G,g as K,h as W,i as Y,j as Z,k as H,l as b,m as L,w as J,p as Q,q as E,E as X,v as V}from"./index-40a06ee6.js";const ee=["accept","disabled","multiple"],te={__name:"Upload",props:{value:{type:[String,Object],default:""},disabled:{type:[Boolean],default:!1},multiple:{type:[Boolean],default:!1},accept:{type:[String],default:".jpg, .jpeg, .png"},size:{type:[Number],default:2}},emits:["update:value"],setup(n,{emit:h}){const r=n,p=(l="B",c=1)=>{const t=Math.pow(2,10),m=Math.pow(t,1),v=Math.pow(t,2),u=Math.pow(t,3),i=Math.pow(t,4),_=Math.pow(t,5),g=Math.pow(t,6),d=Math.pow(t,7),a=Math.pow(t,8);return{B:t,KB:m,MB:v,GB:u,TB:i,PB:_,EB:g,ZB:d,YB:a}[l]*c},f=(l,c,t)=>{let m=!1,v=!1;l.forEach(i=>{const _=c.replace(/\s/g,"").toLowerCase().split(","),g=i.name.slice(i.name.lastIndexOf(".")).toLowerCase(),d=_.includes(g),a=i.size<=p("MB",t);d||(m=!0),a||(v=!0)});const u=[];return m&&u.push("有不支援的檔案格式"),v&&u.push(`有檔案大於${t}M`),u},s=l=>{const c=[...l.target.files],t=f(c,r.accept,r.size);t.length?alert(t.join(`
`)):h("update:value",r.multiple?c:c[0])};return(l,c)=>(N(),M("input",{onChange:s,accept:n.accept,disabled:n.disabled,multiple:n.multiple,type:"file"},null,40,ee))}};const se={key:0,class:"popup_head"},ae={class:"w-72 truncate text-2xl font-bold"},oe={class:"popup_form scrollbar"},ne={__name:"PopupCard",props:{title:{type:[String],default:""},classes:{type:[String],default:""},hasSub:{type:[Boolean],default:!1}},emits:["close"],setup(n,{emit:h}){const r=q(),{mainWidth:p}=I(r),f=s=>h("close");return(s,l)=>(N(),M("div",{class:z(["popup",{"popup-sub":n.hasSub}]),style:G(B(p))},[o("div",{class:z(["popup_window bg-white w-1/3 min-w-[500px]",n.classes])},[o("button",{class:"popup_close",onClick:f},[S(B(A),{class:"icon h-5 w-5"})]),n.title?(N(),M("div",se,[o("h1",ae,j(n.title),1),C(s.$slots,"head",{},void 0,!0)])):O("",!0),o("div",oe,[C(s.$slots,"default",{},void 0,!0)]),C(s.$slots,"footer",{},void 0,!0)],2),o("div",{class:"grow",onClick:f})],6))}},le=U(ne,[["__scopeId","data-v-aa7cd515"]]),ce=o("p",{class:"mb-2 text-gray-500"},"新名稱",-1),ue=o("p",{class:"mt-10 mb-2 text-gray-500"},"檔案",-1),ie={class:"flex items-center"},de={class:"button-rounded cursor-pointer"},re=o("span",null,"上傳",-1),pe={class:"ml-3 w-60 grow truncate"},me={__name:"Node",setup(n){const{findData:h}=K(),{invalidAlert:r}=W(),p=Y(),f=Z(),s=()=>f.push({name:"index"}),l=H(),{createNode:c,updateNode:t,deleteNode:m}=l,{nodeList:v}=I(l),u=b(()=>p.params.id===void 0?"add":"edit"),i=b(()=>p.params.id*1),_=b(()=>h(v.value,i.value)??{}),g=b(()=>{var e;return u.value==="add"?"新增專案節點":`編輯${((e=_.value)==null?void 0:e.name)??""}`}),d=L(""),a=L(null),x=b(()=>{var $,D,k;const e=((k=(D=($=a.value)==null?void 0:$.split("/"))==null?void 0:D.slice(-1))==null?void 0:k[0])??"";return a.value instanceof Blob?a.value.name:e}),P=()=>{const e={name:d.value,file:a.value};if(!e.name)return r();c(e,s)},F=()=>{const e={name:d.value,file:a.value};if(!e.name)return r();t(i.value,e,s)},T=()=>{u.value==="add"?P():F()},R=()=>{confirm("確定要刪除嗎？")&&m(i.value,s)};return J(_,e=>{d.value=(e==null?void 0:e.name)??"",a.value=(e==null?void 0:e.file)??""},{immediate:!0,deep:!0}),(e,w)=>(N(),Q(le,{onClose:s,title:B(g),classes:"w-auto min-w-0 bg-primary-100"},{footer:E(()=>[S(X,{class:"-mb-10",onSave:T,onDelete:R,onCancel:s,hasDel:B(u)!=="add"},null,8,["hasDel"])]),default:E(()=>[ce,S(V,{class:"w-80",value:d.value,"onUpdate:value":w[0]||(w[0]=y=>d.value=y),required:!0},null,8,["value"]),ue,o("div",ie,[o("label",de,[re,S(te,{class:"hidden",value:a.value,"onUpdate:value":w[1]||(w[1]=y=>a.value=y),accept:"*"},null,8,["value"])]),o("span",pe,j(B(x)),1)])]),_:1},8,["title"]))}};export{me as default};
